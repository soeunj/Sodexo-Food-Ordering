<!DOCTYPE html>
<html lang="en">

<head>
  <%- include header.ejs %>
    <script type="text/javascript" src="../js/menu.js"></script>
    <script type="text/javascript" src="../js/order.js"></script>
</head>

<body>
  <nav class="navbar navbar-inverse sidebar" role="navigation">
    <div class="container-fluid">
      <%- include small_device_nav.ejs %>
        <div id="tab" class="collapse navbar-collapse">
        </div>
    </div>
  </nav>
  <div id="main" class="main container-fluid text-center">
  </div>
  <script type="text/javascript">
    var today_day = new Date().getDay();
    var now_hour = new Date().getHours();
    var day_num = {
      "mon": 1,
      "tue": 2,
      "wed": 3,
      "thu": 4,
      "fri": 5
    };

    var data = <%-JSON.stringify(data)%>;
    var type = "<%=type%>";
    console.log(data);
    window.onload = function() {
      if (type == "menu") {
        loadmenu();
      } else if (type == "order") {
        loadorder();
        let orderdate = $('#orderdate').html();
        if(orderdate.length > 10 ){
        $('#orderdate').html(orderdate.toString().slice(0,15));
        }
      }
    }
    if (type == "order" && data.length == 0) {
      $('#order').prop('disabled', true);

    }
    if (type == "order" && data.length > 7) {
      console.log("quit");

    }

    function loadmenu() {

      var html = "";
      html += "<ul class='nav navbar-nav'>";
      html += "<li><a href='/'>HOME<span style='font-size:16px;' class='pull-right hidden-xs glyphicon glyphicon-home'></span></a></li>";
      html += "<li class='active dropdown'>";
      html += "<a href='/menu' class='dropdown-toggle' data-toggle='dropdown'>MENU<span class='caret'></span><span style='font-size:16px;' class='pull-right hidden-xs glyphicon glyphicon-cutlery'></span></a>";
      html += "<ul class='dropdown-menu' role='menu'>";
      html += "<li><a href='/menu'>TODAY</a></li>";
      html += "<li><a href='/menu/mon'>MONDAY</a></li>";
      html += "<li><a href='/menu/tue'>TUESDAY</a></li>";
      html += "<li><a href='/menu/wed'>WEDNESDAY</a></li>";
      html += "<li><a href='/menu/thu'>THURSDAY</a></li>";
      html += "<li><a href='/menu/fri'>FRIDAY</a></li>";
      html += "</ul></li>";
      html += "<li><a href='/order'>ORDER<span style='font-size:16px;' class='pull-right hidden-xs glyphicon glyphicon-shopping-cart'></span></a></li>";
      html += "<li class='dropdown'>";
      html += "<a href='/statistic' class='dropdown-toggle' data-toggle='dropdown'>STATISTIC<span class='caret'></span><span style='font-size:16px;' class='pull-right hidden-xs glyphicon glyphicon-stats'></span></a>";
      html += "<ul class='dropdown-menu' role='menu'>";
      html += "<li><a href='/statistic'>TODAY</a></li><li><a href='/statistic/thismonth'>OTHER</a></li>";
      html += "</ul></li></ul>";
      $('#tab').append(html);
      var html1 = "";
      html1 += "<h2><%=dayofmenu%></h2><p>You can order meals.</br>Click menu which you want to order.</p></br>";
      html1 += "<table class='table table-hover'>";
      html1 += "<thead><tr><th class='col-xs-3 text-center'>Menu</th><th class='col-xs-6 text-center'>Description</th><th class='col-xs-3 text-center'>Price</th></tr></thead>";
      html1 += "<tbody id='menu'>";
      html1 += "<% for(var i=0; i<data.length; i++) {%>";
      html1 += "<tr id='<%=data[i]['category']%>_<%=date%>' onclick='clickmenu(this.id)'>";
      html1 += "<td id='menu_category' class='col-xs-3 text-center'>";
      html1 += "<%=data[i]['category'] %>";
      html1 += "</td>";
      html1 += "<td class='col-xs-6 text-left'>";
      html1 += "<%=data[i]['title_fi']%>";
      html1 += "<%=data[i]['desc_fi']%></br>";
      html1 += "<%=data[i]['title_en']%>";
      html1 += "</td>";
      html1 += "<td class='col-xs-3 text-center'>";
      html1 += "<%=data[i]['price']%></td></tr>";
      html1 += "<% } %>";
      html1 += "</tbody></table>";
      $('#main').append(html1);
    }

    function loadorder() {
      let html2 = "";
      html2 += "<ul class='nav navbar-nav'>";
      html2 += "<li><a href='/'>HOME<span style='font-size:16px;' class='pull-right hidden-xs glyphicon glyphicon-home'></span></a></li>";
      html2 += "<li class='dropdown'>";
      html2 += "<a href='/menu' class='dropdown-toggle' data-toggle='dropdown'>MENU<span class='caret'></span><span style='font-size:16px;' class='pull-right hidden-xs glyphicon glyphicon-cutlery'></span></a>";
      html2 += "<ul class='dropdown-menu' role='menu'>";
      html2 += "<li><a href='/menu'>TODAY</a></li>";
      html2 += "<li><a href='/menu/mon'>MONDAY</a></li>";
      html2 += "<li><a href='/menu/tue'>TUESDAY</a></li>";
      html2 += "<li><a href='/menu/wed'>WEDNESDAY</a></li>";
      html2 += "<li><a href='/menu/thu'>THURSDAY</a></li>";
      html2 += "<li><a href='/menu/fri'>FRIDAY</a></li>";
      html2 += "</ul></li>";
      html2 += "<li class='active'><a href='/order'>ORDER<span style='font-size:16px;' class='pull-right hidden-xs glyphicon glyphicon-shopping-cart'></span></a></li>";
      html2 += "<li class='dropdown'>";
      html2 += "<a href='/statistic' class='dropdown-toggle' data-toggle='dropdown'>STATISTIC<span class='caret'></span><span style='font-size:16px;' class='pull-right hidden-xs glyphicon glyphicon-stats'></span></a>";
      html2 += "<ul class='dropdown-menu' role='menu'>";
      html2 += "<li><a href='/statistic'>TODAY</a></li><li><a href='/statistic/thismonth'>OTHER</a></li>";
      html2 += "</ul></li></ul>";
      $('#tab').append(html2);
      let html3 = "";
      html3 += "<h2>ORDER LIST</h2><p>This is your order list.</br>If you want to confirm your order, click order button.</p></br>";
      html3 += "<table class='table'>";
      html3 += "<thead>";
      html3 +="<tr><th class='col-xs-3 text-center'>Date</th><th class='col-xs-6 text-center'>Menu</th><th class='col-xs-3 text-center'>Count</th><th class='col-xs-3 text-center'>Count Confirm</th><th class='col-xs-3 text-center'>Delete</th></tr></thead>";
      html3 += "<tbody id='orderlist'>";
      html3 += "<% for(var i=0; i<data.length; i++) {%>";
      html3 += "<tr id='<%=data[i]['_id']%>'>";
      html3 += "<td id='orderdate' class='col-xs-3 text-center'>";
      html3 += "<%=data[i]['date']%></td>";
      html3 += "<td class='col-xs-6 text-center'>";
      html3 += "<%=data[i]['menu']%></td>";
      html3 += "<td class='col-xs-3 text-center'>";
      html3 += "<input type='number' id='<%=data[i]['_id']%>_count' value='<%=data[i]['count']%>' class='form-control'></td>";
      html3 += "<td class='col-xs-3 text-center'>";
      html3 += "<button id='<%=data[i]['_id']%>_countsubmit' class='btn btn-default' onclick='confirm_count(this.id)'>";
      html3 += "<i class='glyphicon glyphicon-ok'></i></button></td>";
      html3 += "<td class='col-xs-3 text-center'>";
      html3 += "<button id='delete<%=i%>' class='btn btn-default' onclick='delete_order(this.id)'>";
      html3 += "<i class='glyphicon glyphicon-remove'></i></button></td></tr>";
      html3 += "<% } %>";
      html3 += "</tbody></table>";
      html3 += "<button id='order' class='btn btn-success pull-right' onclick='submitOrder();submitAll()'>Order</button>";
      $('#main').append(html3);
    }
  </script>
</body>

</html>
